package org.opentestsystem.ap.migration.contentupdater;

import org.opentestsystem.ap.common.model.EqItem;
import org.opentestsystem.ap.common.model.content.EqItemContent;

import static org.opentestsystem.ap.common.model.ModelConstants.ItemLanguage.LANG_ESN;

public class EqContentUpdater extends AbstractContentUpdater<EqItem> {

    protected boolean updateEnglishContent(EqItem item, ContentUpdateCommand updateCommand) {
        boolean isContentChanged;
        EqItemContent english = item.getCore().getEn();

        ContentUpdateCommandResult commandResult = updateCommand.applyEnglishContentUpdate(english.getPrompt());
        english.setPrompt(commandResult.getUpdatedContent());
        isContentChanged = commandResult.isContentChanged();

        commandResult = updateCommand.applyEnglishContentUpdate(item.getCore().getScoring().getRubric());
        item.getCore().getScoring().setRubric(commandResult.getUpdatedContent());
        isContentChanged = isContentChanged || commandResult.isContentChanged();

        return isContentChanged;
    }

    protected boolean updateSpanishContent(EqItem item, ContentUpdateCommand updateCommand) {
        boolean isContentChanged;
        EqItemContent english = item.getCore().getEn();
        EqItemContent spanish = item.getTranslations().getEsp();

        ContentUpdateCommandResult commandResult =
                updateCommand.applyTranslatedContentUpdate(LANG_ESN, spanish.getPrompt(), english.getPrompt());
        spanish.setPrompt(commandResult.getUpdatedContent());
        isContentChanged = commandResult.isContentChanged();

        return isContentChanged;
    }
}
