package org.opentestsystem.ap.migration.contentupdater;

import org.opentestsystem.ap.common.model.HtqsItem;
import org.opentestsystem.ap.common.model.content.HtqsItemContent;

import static org.opentestsystem.ap.common.model.ModelConstants.ItemLanguage.LANG_ESN;

public class HtqsContentUpdater extends AbstractContentUpdater<HtqsItem> {

    @Override
    protected void updateEnglishContent(HtqsItem item, ContentUpdateCommand updateCommand) {
        HtqsItemContent englishContent = item.getCore().getEn();
        englishContent.setPrompt(updateCommand.applyEnglishContentUpdate(englishContent.getPrompt()));
        englishContent.getHtqSelectable().setInteractiveText(
            updateCommand.applyEnglishContentUpdate(englishContent.getHtqSelectable().getInteractiveText())
        );

        item.getCore().getScoring().setRubric(
            updateCommand.applyEnglishContentUpdate(item.getCore().getScoring().getRubric()));
    }

    @Override
    protected void updateSpanishContent(HtqsItem item, ContentUpdateCommand updateCommand) {
        HtqsItemContent englishContent = item.getCore().getEn();
        HtqsItemContent spanishContent = item.getTranslations().getEsp();

        spanishContent.setPrompt(
            updateCommand.applyTranslatedContentUpdate(
                LANG_ESN,
                spanishContent.getPrompt(),
                englishContent.getPrompt()
            )
        );

        spanishContent.getHtqSelectable().setInteractiveText(
            updateCommand.applyTranslatedContentUpdate(
                LANG_ESN,
                spanishContent.getHtqSelectable().getInteractiveText(),
                englishContent.getHtqSelectable().getInteractiveText())
        );
    }
}
