package org.opentestsystem.ap.migration.contentupdater;

import org.opentestsystem.ap.common.model.Item;
import org.opentestsystem.ap.common.model.MsItem;
import org.opentestsystem.ap.common.model.content.MsItemContent;

public class MsContentUpdater implements ContentUpdater {
    @Override
    public void updateContent(Item item, ContentUpdateCommand contentUpdateCommand) {
        MsItem msItem = (MsItem) item;
        updateItemContent(msItem.getCore().getEn(), contentUpdateCommand);
        updateItemContent(msItem.getTranslations().getEsp(), contentUpdateCommand);
    }

    private void updateItemContent(MsItemContent content, ContentUpdateCommand updateCommand) {
        content.setPrompt(updateCommand.applyContentUpdate(content.getPrompt()));
        content.getOptions().forEach(itemOption -> {
            itemOption.setRationale(updateCommand.applyContentUpdate(itemOption.getRationale()));
            itemOption.setText(updateCommand.applyContentUpdate(itemOption.getText()));
        });
    }
}
