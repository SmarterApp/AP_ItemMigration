package org.opentestsystem.ap.migration.contentupdater;

import org.opentestsystem.ap.common.model.MsItem;
import org.opentestsystem.ap.common.model.content.MsItemContent;

import static org.opentestsystem.ap.common.model.ModelConstants.ItemLanguage.LANG_ESN;

public class MsContentUpdater extends AbstractContentUpdater<MsItem> {

    @Override
    protected boolean updateEnglishContent(MsItem item, ContentUpdateCommand updateCommand) {
        MsItemContent content = item.getCore().getEn();
        content.setPrompt(updateCommand.applyEnglishContentUpdate(content.getPrompt()));
        content.getOptions().forEach(itemOption -> {
            itemOption.setRationale(updateCommand.applyEnglishContentUpdate(itemOption.getRationale()));
            itemOption.setText(updateCommand.applyEnglishContentUpdate(itemOption.getText()));
        });

        return true;
    }

    @Override
    protected boolean updateSpanishContent(MsItem item, ContentUpdateCommand updateCommand) {
        MsItemContent english = item.getCore().getEn();
        MsItemContent spanish = item.getTranslations().getEsp();
        spanish.setPrompt(updateCommand.applyTranslatedContentUpdate(LANG_ESN, spanish.getPrompt(), english.getPrompt()));
        this.updateSpanishItemOptions(spanish.getOptions(), english.getOptions(), updateCommand);

        return true;
    }
}
