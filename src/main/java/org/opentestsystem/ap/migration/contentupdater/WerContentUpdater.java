package org.opentestsystem.ap.migration.contentupdater;

import org.opentestsystem.ap.common.model.WerItem;
import org.opentestsystem.ap.common.model.content.WerItemContent;

import static org.opentestsystem.ap.common.model.ModelConstants.ItemLanguage.LANG_ESN;

public class WerContentUpdater extends AbstractContentUpdater<WerItem> {

    @Override
    protected void updateEnglishContent(WerItem item, ContentUpdateCommand updateCommand) {
        WerItemContent content = item.getCore().getEn();
        content.setPrompt(updateCommand.applyEnglishContentUpdate(content.getPrompt()));
        content.setRubric(updateCommand.applyEnglishContentUpdate(content.getRubric()));
        content.getExemplarResponses().replaceAll(updateCommand::applyEnglishContentUpdate);
    }

    @Override
    protected void updateSpanishContent(WerItem item, ContentUpdateCommand updateCommand) {
        WerItemContent english = item.getCore().getEn();
        WerItemContent spanish = item.getTranslations().getEsp();

        spanish.setPrompt(updateCommand.applyTranslatedContentUpdate(LANG_ESN, spanish.getPrompt(), english.getPrompt()));
        spanish.setRubric(updateCommand.applyTranslatedContentUpdate(LANG_ESN, spanish.getRubric(), english.getRubric()));

        this.updateSpanishListOfStrings(
            spanish.getExemplarResponses(), english.getExemplarResponses(), updateCommand);
    }
}
