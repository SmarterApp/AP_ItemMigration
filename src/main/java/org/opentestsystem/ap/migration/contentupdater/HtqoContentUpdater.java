package org.opentestsystem.ap.migration.contentupdater;

import org.opentestsystem.ap.common.model.HtqoItem;
import org.opentestsystem.ap.common.model.Item;
import org.opentestsystem.ap.common.model.ItemConstants;
import org.opentestsystem.ap.common.model.content.HtqoItemContent;

@UpdateFor(type = ItemConstants.ItemType.TYPE_HTQO)
public class HtqoContentUpdater implements ContentUpdater {
    @Override
    public void updateContent(Item item, ContentUpdateCommand contentUpdateCommand) {
        HtqoItem htqoItem = (HtqoItem) item;
        updateItemContent(htqoItem.getCore().getEn(), contentUpdateCommand);
        updateItemContent(htqoItem.getTranslations().getEsp(), contentUpdateCommand);
    }

    private void updateItemContent(HtqoItemContent content,
                                   ContentUpdateCommand updateCommand) {
        content.setPrompt(updateCommand.applyContentUpdate(content.getPrompt()));
        content.getHtqOrderable().getOrderableStrings()
                .replaceAll(orderable -> updateCommand.applyContentUpdate(orderable));

    }
}
