package org.opentestsystem.ap.migration.contentupdater;

import org.opentestsystem.ap.common.model.Item;
import org.opentestsystem.ap.common.model.SaItem;
import org.opentestsystem.ap.common.model.content.SaItemContent;

public class SaContentUpdater implements ContentUpdater {
    @Override
    public void updateContent(Item item, ContentUpdateCommand contentUpdateCommand) {
        SaItem saItem = (SaItem) item;
        updateItemContent(saItem.getCore().getEn(), contentUpdateCommand);
        updateItemContent(saItem.getTranslations().getEsp(), contentUpdateCommand);
    }

    /**
     * Run update command on all rich text fields on an SaItemContent
     * @param content
     */
    private void updateItemContent(SaItemContent content,
                                   ContentUpdateCommand updateCommand) {
        content.setPrompt(updateCommand.applyContentUpdate(content.getPrompt()));
        content.getRubrics().replaceAll(updateCommand::applyContentUpdate);
        content.getExemplarResponses().replaceAll(updateCommand::applyContentUpdate);
    }
}

