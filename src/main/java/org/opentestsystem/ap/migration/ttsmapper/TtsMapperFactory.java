package org.opentestsystem.ap.migration.ttsmapper;

import org.opentestsystem.ap.common.exception.SystemException;
import org.opentestsystem.ap.common.model.ModelConstants;
import org.springframework.stereotype.Component;

import java.util.HashMap;
import java.util.Map;

@Component
public class TtsMapperFactory {

    private static final Map<String, TtsMapper> TTS_MAPPER_MAP = buildTtsMapperMap();

    @SuppressWarnings("unchecked")
    private static Map<String, TtsMapper> buildTtsMapperMap() {
        Map ttsMapperMap = new HashMap<String, TtsMapper>();
        ttsMapperMap.put(ModelConstants.ItemType.TYPE_EBSR, new EbsrTtsMapper());
        ttsMapperMap.put(ModelConstants.ItemType.TYPE_EQ, new EqTtsMapper());
        ttsMapperMap.put(ModelConstants.ItemType.TYPE_GI, new GiTtsMapper());
        ttsMapperMap.put(ModelConstants.ItemType.TYPE_HTQO, new HtqoTtsMapper());
        ttsMapperMap.put(ModelConstants.ItemType.TYPE_HTQS, new HtqsTtsMapper());
        ttsMapperMap.put(ModelConstants.ItemType.TYPE_MC, new McTtsMapper());
        ttsMapperMap.put(ModelConstants.ItemType.TYPE_MI, new MiTtsMapper());
        ttsMapperMap.put(ModelConstants.ItemType.TYPE_MS, new MsTtsMapper());
        ttsMapperMap.put(ModelConstants.ItemType.TYPE_SA, new SaTtsMapper());
        ttsMapperMap.put(ModelConstants.ItemType.TYPE_STIM, new StimTtsMapper());
        ttsMapperMap.put(ModelConstants.ItemType.TYPE_TI, new TiTtsMapper());
        ttsMapperMap.put(ModelConstants.ItemType.TYPE_WER, new WerTtsMapper());

        return ttsMapperMap;
    }

    public TtsMapper getTtsMapper(String itemType) {
        if (!TTS_MAPPER_MAP.containsKey(itemType.toLowerCase())) {
            throw new SystemException(String.format("TtsMapper class for item type %s was not found.", itemType));
        }
        return TTS_MAPPER_MAP.get(itemType.toLowerCase());
    }
}
