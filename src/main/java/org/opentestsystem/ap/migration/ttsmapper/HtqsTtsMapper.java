package org.opentestsystem.ap.migration.ttsmapper;

import org.opentestsystem.ap.common.model.HtqsItem;
import org.opentestsystem.ap.common.model.Item;
import org.opentestsystem.ap.common.model.content.HtqsItemContent;
import org.springframework.stereotype.Component;

import java.util.List;

import static org.opentestsystem.ap.common.model.ItemConstants.ItemLanguage.LANG_ENU;
import static org.opentestsystem.ap.common.model.ItemConstants.ItemLanguage.LANG_ESN;

@Component
public class HtqsTtsMapper extends TtsMapper {

    @Override
    public void mergeEquationTTS(Item dataStoreItem, List<TtsElementInfo> ttsElementInfoList) {
        HtqsItem item = (HtqsItem) dataStoreItem;

        setEquationTTS(item.getCore().getEn(), LANG_ENU,  dataStoreItem, ttsElementInfoList);
        item.getCore().getScoring().setRubric(updateTTSOnRichTextEquationImages(
                item.getCore().getScoring().getRubric(), LANG_ENU, dataStoreItem, ttsElementInfoList));

        setEquationTTS(item.getTranslations().getEsp(), LANG_ESN, dataStoreItem, ttsElementInfoList);
    }

    private void setEquationTTS(HtqsItemContent itemContent, String language, Item dataStoreItem, List<TtsElementInfo> ttsElementInfoList) {
        itemContent.setPrompt(updateTTSOnRichTextEquationImages(
                itemContent.getPrompt(), language, dataStoreItem, ttsElementInfoList));

//        TIMS does not support image resources or mathml equations
//        itemContent.getHtqSelectable().setInteractiveText(updateTTSOnRichTextEquationImages(
//                itemContent.getHtqSelectable().getInteractiveText(), language, dataStoreItem, ttsElementInfoList));
    }
}
