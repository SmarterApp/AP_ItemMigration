package org.opentestsystem.ap.migration.model.v0;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;
import lombok.Data;
import org.apache.commons.lang3.StringUtils;

import static org.apache.commons.lang3.StringUtils.EMPTY;

@Data
@JsonIgnoreProperties(ignoreUnknown = true)
public class ItemImageResource {

    @JsonProperty("id")
    private String id;

    @JsonProperty("concept")
    private String concept = EMPTY;

    @JsonProperty("conceptFile")
    private Attachment conceptFile = new Attachment();

    @JsonProperty("productionFile")
    private Attachment productionFile = new Attachment();

    @JsonProperty("altText")
    private String altText = EMPTY;

    @JsonProperty("isProductionFileProvided")
    private boolean productionFileProvided = false;

    public void setConceptFile(Attachment conceptFile) {
        if (conceptFile == null) {
            this.conceptFile = new Attachment();
        } else {
            this.conceptFile = conceptFile;
        }
    }

    public void setProductionFile(Attachment productionFile) {
        if (productionFile == null) {
            this.productionFile = new Attachment();
        } else {
            this.productionFile = productionFile;
        }
    }

    public boolean containsFile(final String fileName) {
        return StringUtils.equals(fileName, conceptFile.getFileName())
                || StringUtils.equals(fileName, productionFile.getFileName());
    }

    public void detachFile(final String fileName) {
        if (StringUtils.equals(fileName, conceptFile.getFileName())) {
            setConceptFile(null);
        } else if (StringUtils.equals(fileName, productionFile.getFileName())) {
            setProductionFile(null);
        }
    }
}
