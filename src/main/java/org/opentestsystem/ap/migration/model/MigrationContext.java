package org.opentestsystem.ap.migration.model;

import lombok.Data;
import org.opentestsystem.ap.common.saaif.model.ImportItem;
import org.opentestsystem.ap.migration.ApplicationProperties;

import java.util.Optional;

/**
 * Context for a migration's containing all necessary information for a migration
 */
@Data
public class MigrationContext {
    private String migrationSetVersion;
    private ApplicationProperties.MigrationDefinition migrationDefinition;
    private ImportItem importItem;
    // if the item is saved to the database during a migration this is set to true,
    // the set handler tracks this and if none of the migrations in the set save, the set handler
    // will save the item
    private boolean itemSavedToDatabase;

    public MigrationContext(String migrationSetVersion, ApplicationProperties.MigrationDefinition migrationDefinition) {
        this.migrationSetVersion = migrationSetVersion;
        this.migrationDefinition = migrationDefinition;
    }

    public MigrationContext(String migrationSetVersion, ApplicationProperties.MigrationDefinition migrationDefinition, ImportItem importItem) {
        this.migrationSetVersion = migrationSetVersion;
        this.migrationDefinition = migrationDefinition;
        this.importItem = importItem;
    }

    public Optional<ImportItem> getImportItem() {
        return Optional.ofNullable(importItem);
    }
}
