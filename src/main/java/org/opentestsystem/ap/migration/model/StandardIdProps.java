package org.opentestsystem.ap.migration.model;

import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@NoArgsConstructor
public class StandardIdProps {
    String claim;

    String domain;

    String target;

    String grade;

    String emphasis;

    String commonCoreStandard;

    String testCategory;

    String targetSet;
    /**
     *
     * @param value
     */
    public StandardIdProps loadFromValue(String idType, String value) {
        String[] valueArray = value.split("\\|");
        if (valueArray.length > 0) {
            String[] firstValue = valueArray[0].split(":");
            if (IatImportConstants.STANDARD_PUB_FORMAT_MATH_V4.equals(idType)
                    || IatImportConstants.STANDARD_PUB_FORMAT_MATH_V5.equals(idType)) {
                // SBAC-MA-v4:1|NBT|E-3|a/s|3.NBT.2
                // SBAC-MA-v5:1|NS|B-7|m|7.NS.A
                if (valueArray.length == 5) {
                    if (firstValue.length == 2) {
                        this.setClaim(firstValue[1]);
                    }
                    this.setDomain(valueArray[1]);
                    setTargetAndGrade(valueArray[2]);
                    this.setEmphasis(valueArray[3]);
                    this.setCommonCoreStandard(valueArray[4]);
                }
            } else if (IatImportConstants.STANDARD_PUB_FORMAT_MATH_V6.equals(idType)) {
                // SBAC-MA-v6:1|S|TS04|E-3
                if (valueArray.length == 4) {
                    if (firstValue.length == 2) {
                        this.setClaim(firstValue[1]);
                    }
                    this.setTestCategory(valueArray[1]);
                    this.setTargetSet(valueArray[2]);
                    setTargetAndGrade(valueArray[3]);
                }
            } else if (IatImportConstants.STANDARD_PUB_FORMAT_ELA_V1.equals(idType)) {
                // SBAC-ELA-v1:2-W|1-3
                // SBAC-ELA-v1:1-IT|9-11|11-12.RI.2
                if (valueArray.length > 1) {
                    if (firstValue.length == 2) {
                        setClaimAndDomain(firstValue[1]);
                        setTargetAndGrade(valueArray[1]);
                    }
                }
                if (valueArray.length == 3) {
                    this.setCommonCoreStandard(valueArray[2]);
                }
            }
        }

        return this;
    }

    private void setTargetAndGrade(String value) {
        String[] valueArray = value.split("-");
        if (valueArray.length == 2) {
            this.setTarget(valueArray[0]);
            this.setGrade(valueArray[1]);
        } else {
            this.setTarget(valueArray[0]);
        }
    }

    private void setClaimAndDomain(String value) {
        String[] valueArray = value.split("-");
        if (valueArray.length == 2) {
            this.setClaim(valueArray[0]);
            this.setDomain(valueArray[1]);
        }
    }


}
