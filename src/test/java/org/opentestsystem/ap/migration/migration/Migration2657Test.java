package org.opentestsystem.ap.migration.migration;

import org.junit.Before;
import org.junit.Test;
import org.opentestsystem.ap.common.config.ItemBankProperties;
import org.opentestsystem.ap.common.itembank.AttachmentValidator;
import org.opentestsystem.ap.migration.ApplicationDependencyProvider;
import org.opentestsystem.ap.migration.ApplicationProperties;

import static org.opentestsystem.ap.common.model.ItemConstants.Section.SECTION_AUDIO;

public class Migration2657Test {

    private static final String STIM_ID = "170646";

    private static final String AUDIO_FILE_NAME = "passage_2547_v11_10248footnote1.ogg";

    private static final String VALID_HTML_ANCHOR_SIMPLE = "<p>" +
            "<a href=\"passage_646_v6_6573_audio1.ogg\" type=\"audio/ogg\" class=\"sound_explicit\" autoplay=\"False\" visible=\"True\"></a>" +
            "</p>";

    private static final String VALID_HTML_ANCHOR = "<p style=\"font-style:normal; font-weight:bold; \">" +
            "<a href=\"passage_646_v6_6573_audio1.ogg\" type=\"audio/ogg\" class=\"sound_explicit\" autoplay=\"False\" visible=\"True\"></a>" +
            "<br/>" +
            "<a href=\"passage_646_v6_6573_audio2.ogg\" type=\"audio/ogg\" class=\"sound_explicit\" autoplay=\"False\" visible=\"True\"></a>" +
            "</p>";

    private static final String HTML_WITH_ANCHOR_BUT_NO_VALID_AUDIO = "<p style=\"font-style:normal; font-weight:bold; \">" +
            "<a href=\"passage_reference.txt\"></a>" +
            "<br/>" +
            "<a href=\"passage_646_v6_6573_audio2.quicktime\"></a>" +
            "</p>";

    private static final String HTML_NO_ANCHORS = "<p style=\"font-style:normal; font-weight:bold; \"><br/></p>";

    AttachmentValidator validator;

    Migration2657 migration;

    @Before
    public void setup() {
        this.validator = new AttachmentValidator(new ItemBankProperties());
        ApplicationDependencyProvider dependencyProvider = new ApplicationDependencyProvider();
        ApplicationProperties appProps = new ApplicationProperties();
        this.migration = new Migration2657(
                dependencyProvider, appProps, null, null, null, null);
    }

    @Test
    public void testAudioFileNameIsValid() {
        this.validator.validateFileName(AUDIO_FILE_NAME, SECTION_AUDIO);
    }
}
