package org.opentestsystem.ap.migration;

import lombok.Data;
import org.opentestsystem.ap.common.model.ModelConstants;
import org.opentestsystem.ap.common.model.ItemImageResource;
import org.opentestsystem.ap.common.saaif.item.ItemRelease;
import org.opentestsystem.ap.common.saaif.item.SaaifAccessElement;
import org.opentestsystem.ap.common.saaif.mapper.model.ImportItem;
import org.opentestsystem.ap.common.saaif.mapper.model.ItemProps;
import org.opentestsystem.ap.common.saaif.metadata.SmarterAppMetadata;

import java.io.IOException;
import java.nio.file.Files;

@Data
public class TestUtil {


    public static final String ITEM_ID = "200000";

    public static final String ITEM_ID_1 = "200001";

    public static final String ITEM_ID_2 = "200002";

    public static final String BRANCH_NAME = "hal@fairwaytech.com";

    public static final String BRANCH_NAME_1 = "bruce@fairwaytech.com";

    public static final String BRANCH_NAME_2 = "clark@fairwaytech.com";

    public static final String MIGRATION_SET_KEY = "iat-32175";

    public static final String MIGRATION_SET_KEY_1 = "iat-1";

    public static final String MIGRATION_SET_KEY_2 = "iat-2";

    public static final String MIGRATION_NAME = "migration8765309";

    public static final String MIGRATION_NAME_1 = "migration0001";

    public static final String MIGRATION_NAME_2 = "migration0002";

    private static final String ERROR_MESSAGE = "Error updating item data";

    private final ApplicationProperties applicationProperties;

    public TestUtil() {
        applicationProperties = new ApplicationProperties();
    }

    public ImportItem getNewImportItem(String enuPrompt) throws IOException {
        ItemRelease itemRelease = new ItemRelease();
        ItemRelease.Item item = new ItemRelease.Item();
        ItemRelease.Item.Content content = new ItemRelease.Item.Content();
        content.setStem(enuPrompt);
        content.setLanguage(ModelConstants.ItemLanguage.LANG_ENU);

        item.getContent().add(content);
        itemRelease.setItem(item);

        ImportItem importItem = new ImportItem();
        ItemProps itemProps = new ItemProps();
        SmarterAppMetadata metadata = new SmarterAppMetadata();
        metadata.setSubject("math");

        importItem.setItemProps(itemProps);
        importItem.setItemRelease(itemRelease);
        importItem.setSmarterAppMetadata(metadata);
        importItem.setExpandedImportItemPath(Files.createTempDirectory("tes"));
        importItem.setItemImportSourcePath(Files.createTempDirectory("testSrc"));

        return importItem;
    }

    public ItemRelease.Item.Content.ApipAccessibility.AccessibilityInfo.AccessElement getNewItemAccessElement() {
        ItemRelease.Item.Content.ApipAccessibility.AccessibilityInfo.AccessElement accessElement =
                new ItemRelease.Item.Content.ApipAccessibility.AccessibilityInfo.AccessElement();

        ItemRelease.Item.Content.ApipAccessibility.AccessibilityInfo.AccessElement.ContentLinkInfo contentLinkInfo =
                new ItemRelease.Item.Content.ApipAccessibility.AccessibilityInfo.AccessElement.ContentLinkInfo();

        ItemRelease.Item.Content.ApipAccessibility.AccessibilityInfo.AccessElement.RelatedElementInfo.ReadAloud readAloud =
                new ItemRelease.Item.Content.ApipAccessibility.AccessibilityInfo.AccessElement.RelatedElementInfo.ReadAloud();

        ItemRelease.Item.Content.ApipAccessibility.AccessibilityInfo.AccessElement.RelatedElementInfo relatedElementInfo =
                new ItemRelease.Item.Content.ApipAccessibility.AccessibilityInfo.AccessElement.RelatedElementInfo();

        ItemRelease.Item.Content.ApipAccessibility.AccessibilityInfo.AccessElement.RelatedElementInfo.BrailleText brailleText =
                new ItemRelease.Item.Content.ApipAccessibility.AccessibilityInfo.AccessElement.RelatedElementInfo.BrailleText();

        relatedElementInfo.setReadAloud(readAloud);
        relatedElementInfo.setBrailleText(brailleText);

        accessElement.setContentLinkInfo(contentLinkInfo);
        accessElement.setRelatedElementInfo(relatedElementInfo);

        return accessElement;
    }

    public ItemImageResource newItemImageResource(String productionFileName) {
        ItemImageResource resource = new ItemImageResource();
        resource.setId("1");
        resource.getProductionFile().setFileName(productionFileName);

        return resource;
    }

    public ItemRelease.Passage.Content.ApipAccessibility.AccessibilityInfo.AccessElement getNewPassageAccessElement() {
        ItemRelease.Passage.Content.ApipAccessibility.AccessibilityInfo.AccessElement accessElement =
                new ItemRelease.Passage.Content.ApipAccessibility.AccessibilityInfo.AccessElement();

        ItemRelease.Passage.Content.ApipAccessibility.AccessibilityInfo.AccessElement.ContentLinkInfo contentLinkInfo =
                new ItemRelease.Passage.Content.ApipAccessibility.AccessibilityInfo.AccessElement.ContentLinkInfo();

        ItemRelease.Passage.Content.ApipAccessibility.AccessibilityInfo.AccessElement.RelatedElementInfo.ReadAloud readAloud =
                new ItemRelease.Passage.Content.ApipAccessibility.AccessibilityInfo.AccessElement.RelatedElementInfo.ReadAloud();

        ItemRelease.Passage.Content.ApipAccessibility.AccessibilityInfo.AccessElement.RelatedElementInfo relatedElementInfo =
                new ItemRelease.Passage.Content.ApipAccessibility.AccessibilityInfo.AccessElement.RelatedElementInfo();

        ItemRelease.Passage.Content.ApipAccessibility.AccessibilityInfo.AccessElement.RelatedElementInfo.BrailleText brailleText =
                new ItemRelease.Passage.Content.ApipAccessibility.AccessibilityInfo.AccessElement.RelatedElementInfo.BrailleText();

        relatedElementInfo.setReadAloud(readAloud);
        relatedElementInfo.setBrailleText(brailleText);

        accessElement.setContentLinkInfo(contentLinkInfo);
        accessElement.setRelatedElementInfo(relatedElementInfo);

        return accessElement;
    }
}
